/*!
 * @pixi/canvas-mesh - v6.3.2
 * Compiled Wed, 04 May 2022 17:49:13 UTC
 *
 * @pixi/canvas-mesh is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
this.PIXI=this.PIXI||{};var _pixi_canvas_mesh=function(e,t,a,r,n,i,s){"use strict";var h=function(){function e(e){this.renderer=e}return e.prototype.render=function(e){var t=this.renderer,r=e.worldTransform;t.context.globalAlpha=e.worldAlpha,t.setBlendMode(e.blendMode),t.setContextTransform(r,e.roundPixels),e.drawMode!==a.DRAW_MODES.TRIANGLES?this._renderTriangleMesh(e):this._renderTriangles(e)},e.prototype._renderTriangleMesh=function(e){for(var t=e.geometry.buffers[0].data.length,a=0;a<t-2;a++){var r=2*a;this._renderDrawTriangle(e,r,r+2,r+4)}},e.prototype._renderTriangles=function(e){for(var t=e.geometry.getIndex().data,a=t.length,r=0;r<a;r+=3){var n=2*t[r],i=2*t[r+1],s=2*t[r+2];this._renderDrawTriangle(e,n,i,s)}},e.prototype._renderDrawTriangle=function(e,a,n,i){var s=this.renderer.context,h=e.geometry.buffers[0].data,o=e.uvs,d=e.texture;if(d.valid){var l=16777215!==e.tint,c=d.baseTexture,v=c.width,u=c.height;l&&e._cachedTint!==e.tint&&(e._cachedTint=e.tint,e._cachedTexture=e._cachedTexture||new t.Texture(c),e._tintedCanvas=r.canvasUtils.getTintedCanvas({texture:e._cachedTexture},e.tint));var p=l?e._tintedCanvas:c.getDrawableSource(),_=o[a]*c.width,g=o[n]*c.width,f=o[i]*c.width,m=o[a+1]*c.height,T=o[n+1]*c.height,x=o[i+1]*c.height,M=h[a],y=h[n],P=h[i],I=h[a+1],w=h[n+1],C=h[i+1],b=e.canvasPadding/this.renderer.resolution;if(b>0){var S=e.worldTransform,A=S.a,D=S.b,U=S.c,N=S.d,X=(M+y+P)/3,B=(I+w+C)/3,R=M-X,E=I-B,H=A*R+U*E,O=D*R+N*E,V=Math.sqrt(H*H+O*O),j=1+b/V;M=X+R*j,I=B+E*j,H=A*(R=y-X)+U*(E=w-B),O=D*R+N*E,y=X+R*(j=1+b/(V=Math.sqrt(H*H+O*O))),w=B+E*j,H=A*(R=P-X)+U*(E=C-B),O=D*R+N*E,P=X+R*(j=1+b/(V=Math.sqrt(H*H+O*O))),C=B+E*j}s.save(),s.beginPath(),s.moveTo(M,I),s.lineTo(y,w),s.lineTo(P,C),s.closePath(),s.clip();var q=_*T+m*f+g*x-T*f-m*g-_*x,F=M*T+m*P+y*x-T*P-m*y-M*x,G=_*y+M*f+g*P-y*f-M*g-_*P,W=_*T*P+m*y*f+M*g*x-M*T*f-m*g*P-_*y*x,L=I*T+m*C+w*x-T*C-m*w-I*x,k=_*w+I*f+g*C-w*f-I*g-_*C,z=_*T*C+m*w*f+I*g*x-I*T*f-m*g*C-_*w*x;s.transform(F/q,L/q,G/q,k/q,W/q,z/q),s.drawImage(p,0,0,v*c.resolution,u*c.resolution,0,0,v,u),s.restore(),this.renderer.invalidateBlendMode()}},e.prototype.renderMeshFlat=function(e){var t=this.renderer.context,a=e.geometry.getBuffer("aVertexPosition").data,r=a.length/2;t.beginPath();for(var n=1;n<r-2;++n){var i=2*n,s=a[i],h=a[i+1],o=a[i+2],d=a[i+3],l=a[i+4],c=a[i+5];t.moveTo(s,h),t.lineTo(o,d),t.lineTo(l,c)}t.fillStyle="#FF0000",t.fill(),t.closePath()},e.prototype.destroy=function(){this.renderer=null},e}();n.settings.MESH_CANVAS_PADDING=0,i.MeshMaterial.prototype._renderCanvas=function(e,t){e.plugins.mesh.render(t)},s.NineSlicePlane.prototype._cachedTint=16777215,s.NineSlicePlane.prototype._tintedCanvas=null,s.NineSlicePlane.prototype._canvasUvs=null,s.NineSlicePlane.prototype._renderCanvas=function(e){var t=e.context,a=this.worldTransform,n=16777215!==this.tint,i=this.texture;if(i.valid){n&&this._cachedTint!==this.tint&&(this._cachedTint=this.tint,this._tintedCanvas=r.canvasUtils.getTintedCanvas(this,this.tint));var s=n?this._tintedCanvas:i.baseTexture.getDrawableSource();this._canvasUvs||(this._canvasUvs=[0,0,0,0,0,0,0,0]);var h=this.vertices,o=this._canvasUvs,d=n?0:i.frame.x,l=n?0:i.frame.y,c=d+i.frame.width,v=l+i.frame.height;o[0]=d,o[1]=d+this._leftWidth,o[2]=c-this._rightWidth,o[3]=c,o[4]=l,o[5]=l+this._topHeight,o[6]=v-this._bottomHeight,o[7]=v;for(var u=0;u<8;u++)o[u]*=i.baseTexture.resolution;t.globalAlpha=this.worldAlpha,e.setBlendMode(this.blendMode),e.setContextTransform(a,this.roundPixels);for(var p=0;p<3;p++)for(var _=0;_<3;_++){var g=2*_+8*p,f=Math.max(1,o[_+1]-o[_]),m=Math.max(1,o[p+5]-o[p+4]),T=Math.max(1,h[g+10]-h[g]),x=Math.max(1,h[g+11]-h[g+1]);t.drawImage(s,o[_],o[p+4],f,m,h[g],h[g+1],T,x)}}};var o=!1;return i.Mesh.prototype._cachedTint=16777215,i.Mesh.prototype._tintedCanvas=null,i.Mesh.prototype._cachedTexture=null,i.Mesh.prototype._renderCanvas=function(e){this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.material._renderCanvas?this.material._renderCanvas(e,this):o||(o=!0,globalThis.console&&console.warn("Mesh with custom shaders are not supported in CanvasRenderer."))},i.Mesh.prototype._canvasPadding=null,Object.defineProperty(i.Mesh.prototype,"canvasPadding",{get:function(){return null!==this._canvasPadding?this._canvasPadding:n.settings.MESH_CANVAS_PADDING},set:function(e){this._canvasPadding=e}}),s.SimpleMesh.prototype._renderCanvas=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(e,this)},s.SimpleRope.prototype._renderCanvas=function(e){(this.autoUpdate||this.geometry._width!==this.shader.texture.height)&&(this.geometry._width=this.shader.texture.height,this.geometry.update()),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(e,this)},e.CanvasMeshRenderer=h,Object.defineProperty(e,"__esModule",{value:!0}),e}({},PIXI,PIXI,PIXI,PIXI,PIXI,PIXI);Object.assign(this.PIXI,_pixi_canvas_mesh);
//# sourceMappingURL=canvas-mesh.min.js.map
