/*!
 * @pixi/canvas-graphics - v6.3.2
 * Compiled Wed, 04 May 2022 17:49:13 UTC
 *
 * @pixi/canvas-graphics is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("@pixi/core"),i=require("@pixi/math"),r=require("@pixi/canvas-renderer"),a=require("@pixi/graphics"),n=function(){function e(){}return e.offsetPolygon=function(t,i){var r=[],a=t.length;i=e.isPolygonClockwise(t)?i:-1*i;for(var n=0;n<a;n+=2){var o=n-2;o<0&&(o+=a);var l=(n+2)%a,s=t[n]-t[o],h=t[n+1]-t[o+1],v=Math.sqrt(s*s+h*h);s/=v,h/=v;var g=-(h*=i),p=s*=i,c=[t[o]+g,t[o+1]+p],f=[t[n]+g,t[n+1]+p],u=t[l]-t[n],d=t[l+1]-t[n+1];u/=v=Math.sqrt(u*u+d*d),d/=v;var T=-(d*=i),m=u*=i,x=[t[n]+T,t[n+1]+m],y=[t[l]+T,t[l+1]+m],b=e.findIntersection(c[0],c[1],f[0],f[1],x[0],x[1],y[0],y[1]);b&&r.push.apply(r,b)}return r},e.findIntersection=function(e,t,i,r,a,n,o,l){var s=(l-n)*(i-e)-(o-a)*(r-t),h=(o-a)*(t-n)-(l-n)*(e-a);if(0===s)return 0===h&&0===(i-e)*(t-n)-(r-t)*(e-a)?[(e+i)/2,(t+r)/2]:null;var v=h/s;return[e+v*(i-e),t+v*(r-t)]},e.isPolygonClockwise=function(e){for(var t=0,i=0,r=e.length-2;i<e.length;r=i,i+=2)t+=(e[i]-e[r])*(e[i+1]+e[r+1]);return t>0},e}(),o=function(){function e(e){this._svgMatrix=null,this._tempMatrix=new i.Matrix,this.renderer=e}return e.prototype._calcCanvasStyle=function(e,a){var n;return e.texture&&e.texture.baseTexture!==t.Texture.WHITE.baseTexture?e.texture.valid?(n=r.canvasUtils.getTintedPattern(e.texture,a),this.setPatternTransform(n,e.matrix||i.Matrix.IDENTITY)):n="#808080":n="#"+("00000"+(0|a).toString(16)).slice(-6),n},e.prototype.render=function(e){var t=this.renderer,r=t.context,a=e.worldAlpha,n=e.transform.worldTransform;t.setContextTransform(n),t.setBlendMode(e.blendMode);for(var o,l,s=e.geometry.graphicsData,h=(e.tint>>16&255)/255,v=(e.tint>>8&255)/255,g=(255&e.tint)/255,p=0;p<s.length;p++){var c=s[p],f=c.shape,u=c.fillStyle,d=c.lineStyle,T=0|c.fillStyle.color,m=0|c.lineStyle.color;if(c.matrix&&t.setContextTransform(n.copyTo(this._tempMatrix).append(c.matrix)),u.visible){var x=((T>>16&255)/255*h*255<<16)+((T>>8&255)/255*v*255<<8)+(255&T)/255*g*255;o=this._calcCanvasStyle(u,x)}if(d.visible){var y=((m>>16&255)/255*h*255<<16)+((m>>8&255)/255*v*255<<8)+(255&m)/255*g*255;l=this._calcCanvasStyle(d,y)}if(r.lineWidth=d.width,r.lineCap=d.cap,r.lineJoin=d.join,r.miterLimit=d.miterLimit,c.type===i.SHAPES.POLY){r.beginPath();var b=(A=f).points,P=c.holes,S=void 0,M=void 0,C=void 0,w=void 0,_=void 0;r.moveTo(b[0],b[1]);for(var k=2;k<b.length;k+=2)r.lineTo(b[k],b[k+1]);if(A.closeStroke&&r.closePath(),P.length>0){_=[],S=0,C=b[0],w=b[1];for(k=2;k+2<b.length;k+=2)S+=(b[k]-C)*(b[k+3]-w)-(b[k+2]-C)*(b[k+1]-w);for(var R=0;R<P.length;R++)if(b=P[R].shape.points){M=0,C=b[0],w=b[1];for(k=2;k+2<b.length;k+=2)M+=(b[k]-C)*(b[k+3]-w)-(b[k+2]-C)*(b[k+1]-w);if(M*S<0){r.moveTo(b[0],b[1]);for(k=2;k<b.length;k+=2)r.lineTo(b[k],b[k+1])}else{r.moveTo(b[b.length-2],b[b.length-1]);for(k=b.length-4;k>=0;k-=2)r.lineTo(b[k],b[k+1])}P[R].shape.closeStroke&&r.closePath(),_[R]=M*S<0}}u.visible&&(r.globalAlpha=u.alpha*a,r.fillStyle=o,r.fill()),d.visible&&this.paintPolygonStroke(A,d,l,P,_,a,r)}else if(c.type===i.SHAPES.RECT){var A=f;if(u.visible&&(r.globalAlpha=u.alpha*a,r.fillStyle=o,r.fillRect(A.x,A.y,A.width,A.height)),d.visible){var q=d.width*(.5-(1-d.alignment)),E=A.width+2*q,I=A.height+2*q;r.globalAlpha=d.alpha*a,r.strokeStyle=l,r.strokeRect(A.x-q,A.y-q,E,I)}}else if(c.type===i.SHAPES.CIRC){A=f;if(r.beginPath(),r.arc(A.x,A.y,A.radius,0,2*Math.PI),r.closePath(),u.visible&&(r.globalAlpha=u.alpha*a,r.fillStyle=o,r.fill()),d.visible){if(.5!==d.alignment){q=d.width*(.5-(1-d.alignment));r.beginPath(),r.arc(A.x,A.y,A.radius+q,0,2*Math.PI),r.closePath()}r.globalAlpha=d.alpha*a,r.strokeStyle=l,r.stroke()}}else if(c.type===i.SHAPES.ELIP){A=f;if((Y=1===d.alignment)||this.paintEllipse(A,u,d,o,a,r),d.visible){if(.5!==d.alignment){var z=.5522848,G=(q=d.width*(.5-(1-d.alignment)),2*(A.width+q)),H=2*(A.height+q),L=A.x-G/2,D=A.y-H/2,j=G/2*z,B=H/2*z,N=L+G,O=D+H,V=L+G/2,W=D+H/2;r.beginPath(),r.moveTo(L,W),r.bezierCurveTo(L,W-B,V-j,D,V,D),r.bezierCurveTo(V+j,D,N,W-B,N,W),r.bezierCurveTo(N,W+B,V+j,O,V,O),r.bezierCurveTo(V-j,O,L,W+B,L,W),r.closePath()}r.globalAlpha=d.alpha*a,r.strokeStyle=l,r.stroke()}Y&&this.paintEllipse(A,u,d,o,a,r)}else if(c.type===i.SHAPES.RREC){var Y;A=f;if((Y=1===d.alignment)||this.paintRoundedRectangle(A,u,d,o,a,r),d.visible){if(.5!==d.alignment){E=A.width,I=A.height,q=d.width*(.5-(1-d.alignment));var J=A.x-q,U=A.y-q,F=A.width+2*q,K=A.height+2*q,Q=q*(d.alignment>=1?Math.min(F/E,K/I):Math.min(E/F,I/K)),X=A.radius+Q,Z=Math.min(F,K)/2;X=X>Z?Z:X,r.beginPath(),r.moveTo(J,U+X),r.lineTo(J,U+K-X),r.quadraticCurveTo(J,U+K,J+X,U+K),r.lineTo(J+F-X,U+K),r.quadraticCurveTo(J+F,U+K,J+F,U+K-X),r.lineTo(J+F,U+X),r.quadraticCurveTo(J+F,U,J+F-X,U),r.lineTo(J+X,U),r.quadraticCurveTo(J,U,J,U+X),r.closePath()}r.globalAlpha=d.alpha*a,r.strokeStyle=l,r.stroke()}Y&&this.paintRoundedRectangle(A,u,d,o,a,r)}}},e.prototype.paintPolygonStroke=function(e,t,i,r,a,o,l){if(.5!==t.alignment){var s=t.width*(.5-(1-t.alignment)),h=n.offsetPolygon(e.points,s),v=void 0;l.beginPath(),l.moveTo(h[0],h[1]);for(var g=2;g<h.length;g+=2)l.lineTo(h[g],h[g+1]);e.closeStroke&&l.closePath();for(var p=0;p<r.length;p++){if(v=r[p].shape.points,h=n.offsetPolygon(v,s),a[p]){l.moveTo(h[0],h[1]);for(g=2;g<h.length;g+=2)l.lineTo(h[g],h[g+1])}else{l.moveTo(h[h.length-2],h[h.length-1]);for(g=h.length-4;g>=0;g-=2)l.lineTo(h[g],h[g+1])}r[p].shape.closeStroke&&l.closePath()}}l.globalAlpha=t.alpha*o,l.strokeStyle=i,l.stroke()},e.prototype.paintEllipse=function(e,t,i,r,a,n){var o=2*e.width,l=2*e.height,s=e.x-o/2,h=e.y-l/2,v=.5522848,g=o/2*v,p=l/2*v,c=s+o,f=h+l,u=s+o/2,d=h+l/2;0===i.alignment&&n.save(),n.beginPath(),n.moveTo(s,d),n.bezierCurveTo(s,d-p,u-g,h,u,h),n.bezierCurveTo(u+g,h,c,d-p,c,d),n.bezierCurveTo(c,d+p,u+g,f,u,f),n.bezierCurveTo(u-g,f,s,d+p,s,d),n.closePath(),0===i.alignment&&n.clip(),t.visible&&(n.globalAlpha=t.alpha*a,n.fillStyle=r,n.fill()),0===i.alignment&&n.restore()},e.prototype.paintRoundedRectangle=function(e,t,i,r,a,n){var o=e.x,l=e.y,s=e.width,h=e.height,v=e.radius,g=Math.min(s,h)/2;v=v>g?g:v,0===i.alignment&&n.save(),n.beginPath(),n.moveTo(o,l+v),n.lineTo(o,l+h-v),n.quadraticCurveTo(o,l+h,o+v,l+h),n.lineTo(o+s-v,l+h),n.quadraticCurveTo(o+s,l+h,o+s,l+h-v),n.lineTo(o+s,l+v),n.quadraticCurveTo(o+s,l,o+s-v,l),n.lineTo(o+v,l),n.quadraticCurveTo(o,l,o,l+v),n.closePath(),0===i.alignment&&n.clip(),t.visible&&(n.globalAlpha=t.alpha*a,n.fillStyle=r,n.fill()),0===i.alignment&&n.restore()},e.prototype.setPatternTransform=function(e,t){if(!1!==this._svgMatrix){if(!this._svgMatrix){var i=document.createElementNS("http://www.w3.org/2000/svg","svg");if(i&&i.createSVGMatrix&&(this._svgMatrix=i.createSVGMatrix()),!this._svgMatrix||!e.setTransform)return void(this._svgMatrix=!1)}this._svgMatrix.a=t.a,this._svgMatrix.b=t.b,this._svgMatrix.c=t.c,this._svgMatrix.d=t.d,this._svgMatrix.e=t.tx,this._svgMatrix.f=t.ty,e.setTransform(this._svgMatrix.inverse())}},e.prototype.destroy=function(){this.renderer=null,this._svgMatrix=null,this._tempMatrix=null},e}(),l=new i.Matrix;a.Graphics.prototype.generateCanvasTexture=function(i,a){void 0===a&&(a=1);var n=this.getLocalBounds(),o=t.RenderTexture.create({width:n.width,height:n.height,scaleMode:i,resolution:a});e||(e=new r.CanvasRenderer),this.transform.updateLocalTransform(),this.transform.localTransform.copyTo(l),l.invert(),l.tx-=n.x,l.ty-=n.y,e.render(this,{renderTexture:o,clear:!0,transform:l});var s=t.Texture.from(o.baseTexture._canvasRenderTarget.canvas,{scaleMode:i});return s.baseTexture.setResolution(a),s},a.Graphics.prototype.cachedGraphicsData=[],a.Graphics.prototype._renderCanvas=function(e){!0!==this.isMask&&(this.finishPoly(),e.plugins.graphics.render(this))},exports.CanvasGraphicsRenderer=o;
//# sourceMappingURL=canvas-graphics.min.js.map
